<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2026 ì£¼íƒì²­ì•½ ë§ì¶¤ ì „ëµ ë¶„ì„ê¸°</title>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
<style>
:root {
  --bg: #06090F;
  --bg2: #0C1220;
  --card: #111827;
  --card2: #151d2e;
  --card-hover: #182035;
  --border: #1E293B;
  --border-l: #283548;
  --accent: #22D3EE;
  --accent-dim: rgba(34,211,238,0.12);
  --green: #34D399;
  --green-dim: rgba(52,211,153,0.12);
  --red: #F87171;
  --red-dim: rgba(248,113,113,0.10);
  --orange: #FBBF24;
  --orange-dim: rgba(251,191,36,0.12);
  --purple: #A78BFA;
  --purple-dim: rgba(167,139,250,0.12);
  --pink: #F472B6;
  --pink-dim: rgba(244,114,182,0.12);
  --text: #F1F5F9;
  --text-dim: #94A3B8;
  --text-muted: #546178;
}
*{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'Pretendard','Noto Sans KR',-apple-system,sans-serif;background:var(--bg);color:var(--text);min-height:100vh;min-height:100dvh;-webkit-font-smoothing:antialiased;overflow-x:hidden}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
input::placeholder{color:var(--text-muted)}

@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideIn{from{opacity:0;transform:translateX(-14px)}to{opacity:1;transform:translateX(0)}}
@keyframes barGrow{from{width:0}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.55}}

/* ===== HEADER ===== */
.header{padding:30px 20px 0;text-align:center;background:linear-gradient(180deg,var(--bg2),var(--bg));position:relative;overflow:hidden}
.header::before{content:'';position:absolute;top:-60%;left:50%;transform:translateX(-50%);width:700px;height:350px;background:radial-gradient(ellipse,rgba(34,211,238,0.05),transparent 70%);pointer-events:none}
.header-tag{font-size:10px;font-weight:700;color:var(--accent);letter-spacing:.16em;text-transform:uppercase;margin-bottom:8px}
.header h1{font-size:24px;font-weight:900;letter-spacing:-.03em;margin-bottom:6px;background:linear-gradient(135deg,var(--text),var(--accent));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.header p{font-size:12px;color:var(--text-muted);line-height:1.7;max-width:440px;margin:0 auto}

/* ===== TABS ===== */
.tab-bar{display:flex;gap:0;margin-top:20px;border-bottom:1.5px solid var(--border);position:sticky;top:0;z-index:100;background:var(--bg);padding:0 4px}
.tab-btn{flex:1;padding:13px 6px 12px;font-size:13px;font-weight:600;color:var(--text-muted);background:none;border:none;border-bottom:2.5px solid transparent;cursor:pointer;transition:all .2s;white-space:nowrap;letter-spacing:-.01em;position:relative}
.tab-btn:hover{color:var(--text-dim)}
.tab-btn.active{color:var(--accent);border-bottom-color:var(--accent)}
.tab-btn .tab-icon{display:block;font-size:16px;margin-bottom:3px}
.tab-btn .tab-num{position:absolute;top:6px;right:12px;min-width:18px;height:18px;border-radius:9px;font-size:10px;font-weight:800;display:none;align-items:center;justify-content:center;line-height:1}
.tab-btn .tab-num.show{display:flex}

/* ===== CONTAINER ===== */
.container{max-width:740px;margin:0 auto;padding:0 14px 90px}
.tab-panel{display:none;padding-top:24px}
.tab-panel.active{display:block;animation:fadeUp .4s ease}

/* ===== SECTION ===== */
.sec-head{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.sec-icon{width:30px;height:30px;border-radius:9px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}
.sec-head h2{font-size:17px;font-weight:800}
.sec-head h2 span{font-size:13px;font-weight:600;margin-left:6px}
.sec-sub{font-size:12px;color:var(--text-muted);margin:-10px 0 18px 40px;line-height:1.6}

/* ===== FORM ===== */
.form-card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:24px 20px}
.form-grid{display:flex;flex-wrap:wrap;gap:16px}
.field{flex:1 1 100%;min-width:0}
.field.half{flex:1 1 47%;min-width:170px}
.field label{display:block;font-size:13px;color:var(--text-dim);margin-bottom:6px;font-weight:500}
.field label small{color:var(--text-muted);font-size:11px;margin-left:4px;font-weight:400}
.field input{width:100%;padding:11px 14px;border-radius:10px;border:1.5px solid var(--border);background:var(--bg2);color:var(--text);font-size:14px;outline:none;transition:border-color .2s}
.field input:focus{border-color:var(--accent)}
.input-wrap{position:relative}
.input-suffix{position:absolute;right:14px;top:50%;transform:translateY(-50%);color:var(--text-muted);font-size:13px;pointer-events:none}
.opt-group{display:flex;gap:8px;flex-wrap:wrap}
.opt-btn{flex:1;min-width:76px;padding:10px 10px;border-radius:10px;border:1.5px solid var(--border);background:var(--bg2);color:var(--text-dim);font-size:13px;font-weight:500;cursor:pointer;transition:all .2s;text-align:center}
.opt-btn:hover{border-color:var(--accent);color:var(--accent)}
.opt-btn.active{border-color:var(--accent);background:var(--accent-dim);color:var(--accent);font-weight:700}
.analyze-btn{width:100%;margin-top:24px;padding:15px 0;border-radius:13px;border:none;background:linear-gradient(135deg,#22D3EE,#06B6D4);color:var(--bg);font-size:16px;font-weight:800;cursor:pointer;letter-spacing:.02em;transition:all .25s;box-shadow:0 4px 24px rgba(34,211,238,.25)}
.analyze-btn:hover{box-shadow:0 6px 36px rgba(34,211,238,.4);transform:translateY(-1px)}
.analyze-btn:active{transform:translateY(0)}
.analyze-btn:disabled{opacity:.5;cursor:not-allowed;transform:none;box-shadow:none}

/* ===== EMPTY STATE ===== */
.empty-state{text-align:center;padding:60px 20px;color:var(--text-muted)}
.empty-state .empty-icon{font-size:42px;margin-bottom:12px;opacity:.5}
.empty-state .empty-title{font-size:16px;font-weight:700;color:var(--text-dim);margin-bottom:6px}
.empty-state .empty-desc{font-size:13px;line-height:1.7}
.empty-state .go-btn{display:inline-block;margin-top:16px;padding:10px 24px;border-radius:10px;border:1.5px solid var(--accent);background:var(--accent-dim);color:var(--accent);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s}
.empty-state .go-btn:hover{background:var(--accent);color:var(--bg)}

/* ===== STATS ===== */
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:24px}
.stat-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:16px 10px;text-align:center}
.stat-icon{font-size:20px;margin-bottom:4px}
.stat-value{font-size:22px;font-weight:900}
.stat-label{font-size:10px;color:var(--text-muted);margin-top:2px;font-weight:600}

/* ===== RESULT CARDS ===== */
.result-card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px 20px;cursor:pointer;transition:all .2s;position:relative;overflow:hidden;margin-bottom:10px}
.result-card:hover{background:var(--card-hover)}
.result-card.top::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--accent),transparent)}
.result-head{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
.result-left{display:flex;align-items:center;gap:12px;flex:1}
.rank-num{width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:900;flex-shrink:0}
.result-name{font-size:15px;font-weight:700;margin-bottom:4px}
.badges{display:flex;gap:5px;flex-wrap:wrap}
.badge{display:inline-flex;align-items:center;padding:3px 9px;border-radius:6px;font-size:11px;font-weight:700;white-space:nowrap}
.arrow{font-size:10px;color:var(--text-muted);transition:transform .2s;margin-top:4px}
.result-card.open .arrow{transform:rotate(180deg)}
.score-section{margin-top:10px}
.score-label{font-size:12px;color:var(--text-dim);margin-bottom:5px}
.score-row{display:flex;align-items:center;gap:10px}
.score-track{flex:1;height:8px;border-radius:4px;background:var(--border);overflow:hidden}
.score-fill{height:100%;border-radius:4px;animation:barGrow .8s ease}
.score-num{font-size:14px;font-weight:800;min-width:56px;text-align:right}
.detail-panel{margin-top:14px;padding-top:14px;border-top:1px solid var(--border);display:none}
.result-card.open .detail-panel{display:block;animation:fadeUp .3s ease}
.detail-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px 16px}
.detail-key{font-size:10px;color:var(--text-muted);margin-bottom:2px;text-transform:uppercase;letter-spacing:.04em}
.detail-val{font-size:13px;color:var(--text-dim);font-weight:500}
.warn-tags{margin-top:10px;display:flex;flex-wrap:wrap;gap:4px}
.warn-tag{font-size:11px;padding:2px 8px;border-radius:4px}

/* ===== INELIGIBLE ===== */
.ineligible-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px 18px;margin-bottom:8px;opacity:.7}
.ineligible-head{display:flex;justify-content:space-between;align-items:center}
.ineligible-name{font-size:14px;color:var(--text-dim)}
.ineligible-cat{font-size:12px;color:var(--text-muted);margin-left:8px}
.reason-tags{margin-top:6px;display:flex;flex-wrap:wrap;gap:4px}

/* ===== SUPPLY ===== */
.supply-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
.supply-card{background:var(--card);border:1px solid var(--border);border-radius:13px;padding:16px 18px;transition:border-color .2s}
.supply-card:hover{border-color:var(--border-l)}
.supply-card.recommended{border-color:rgba(34,211,238,.2)}
.supply-card.recommended::before{content:'ì¶”ì²œ';position:absolute;top:10px;right:12px;font-size:10px;font-weight:700;color:var(--accent);background:var(--accent-dim);padding:2px 8px;border-radius:4px}
.supply-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;gap:8px}
.supply-name{font-size:14px;font-weight:800}
.supply-info{display:grid;grid-template-columns:1fr 1fr;gap:7px}
.supply-key{font-size:10px;color:var(--text-muted)}
.supply-val{font-size:13px;color:var(--text-dim);font-weight:600}
.supply-filter-bar{display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap}
.supply-filter{padding:7px 14px;border-radius:8px;border:1.5px solid var(--border);background:var(--bg2);color:var(--text-muted);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s}
.supply-filter:hover{border-color:var(--text-muted);color:var(--text-dim)}
.supply-filter.active{border-color:var(--accent);background:var(--accent-dim);color:var(--accent)}
.supply-total{font-size:12px;color:var(--text-muted);margin-bottom:16px}
.supply-total b{color:var(--accent);font-weight:800}

/* ===== TABLE ===== */
.data-table-wrap{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-top:20px}
.data-table{width:100%;border-collapse:collapse}
.data-table thead th{padding:13px 16px;text-align:left;color:var(--text-muted);font-weight:700;font-size:11px;letter-spacing:.04em;background:var(--bg2);border-bottom:1px solid var(--border)}
.data-table tbody td{padding:13px 16px;font-size:13px;color:var(--text-dim);border-bottom:1px solid var(--border)}
.data-table tbody tr:last-child td{border-bottom:none}
.data-table tbody tr:hover{background:rgba(255,255,255,.015)}

/* ===== ROADMAP ===== */
.roadmap-step{display:flex;gap:16px;position:relative}
.roadmap-line{display:flex;flex-direction:column;align-items:center;min-width:44px}
.roadmap-dot{width:44px;height:44px;border-radius:13px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:16px;border:2.5px solid;flex-shrink:0}
.roadmap-connector{flex:1;width:2px;background:var(--border);margin-top:6px}
.roadmap-content{flex:1;padding-bottom:30px}
.roadmap-period{font-size:11px;font-weight:700;letter-spacing:.06em;margin-bottom:3px}
.roadmap-title{font-size:17px;font-weight:800;margin-bottom:12px}
.roadmap-items{display:flex;flex-direction:column;gap:8px}
.roadmap-item{font-size:13px;color:var(--text-dim);padding:10px 14px 10px 30px;position:relative;line-height:1.6;background:var(--card);border:1px solid var(--border);border-radius:10px;transition:border-color .2s}
.roadmap-item:hover{border-color:var(--border-l)}
.roadmap-item::before{content:'â€º';position:absolute;left:14px;font-weight:900;font-size:15px}
.roadmap-check{position:absolute;right:12px;top:50%;transform:translateY(-50%);width:20px;height:20px;border-radius:6px;border:1.5px solid var(--border);background:var(--bg2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:11px;color:transparent;transition:all .2s}
.roadmap-check.checked{border-color:var(--green);background:var(--green-dim);color:var(--green)}

/* ===== DISCLAIMER ===== */
.disclaimer{margin-top:28px;padding:16px 20px;background:var(--card);border:1px solid var(--border);border-radius:11px;font-size:11px;color:var(--text-muted);line-height:1.8;text-align:center}

/* ===== RESPONSIVE ===== */
@media(max-width:560px){
  .header h1{font-size:20px}
  .tab-btn{font-size:11px;padding:11px 2px 10px}
  .tab-btn .tab-icon{font-size:14px}
  .field.half{flex:1 1 100%}
  .stats-grid{grid-template-columns:repeat(2,1fr)}
  .supply-grid{grid-template-columns:1fr}
  .detail-grid{grid-template-columns:1fr 1fr}
  .data-table-wrap{overflow-x:auto}
}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-tag">2026 Housing Subscription Analyzer</div>
  <h1>ì£¼íƒì²­ì•½ ë§ì¶¤ ì „ëµ ë¶„ì„ê¸°</h1>
  <p>ê°œì¸ ì¡°ê±´ ì…ë ¥ â†’ ìê²© íŒì • â†’ ì¶”ì²œ ë‹¨ì§€ â†’ ì‹¤í–‰ ë¡œë“œë§µê¹Œì§€ í•œ ë²ˆì—</p>
</div>

<!-- TABS -->
<div style="max-width:740px;margin:0 auto;padding:0 14px">
<nav class="tab-bar" id="tabBar">
  <button class="tab-btn active" data-tab="tab1" onclick="switchTab('tab1')">
    <span class="tab-icon">âœï¸</span>ì¡°ê±´ ì…ë ¥
  </button>
  <button class="tab-btn" data-tab="tab2" onclick="switchTab('tab2')">
    <span class="tab-icon">ğŸ¯</span>ì „ëµ ë¶„ì„
    <span class="tab-num" id="numEligible"></span>
  </button>
  <button class="tab-btn" data-tab="tab3" onclick="switchTab('tab3')">
    <span class="tab-icon">ğŸ—</span>ê³µê¸‰ ë‹¨ì§€
    <span class="tab-num" id="numSupply"></span>
  </button>
  <button class="tab-btn" data-tab="tab4" onclick="switchTab('tab4')">
    <span class="tab-icon">ğŸ—º</span>ë¡œë“œë§µ
  </button>
</nav>
</div>

<div class="container">

  <!-- ===================== TAB 1: ì¡°ê±´ ì…ë ¥ ===================== -->
  <div class="tab-panel active" id="tab1">
    <div class="sec-head">
      <div class="sec-icon" style="background:var(--accent-dim)">ğŸ“‹</div>
      <h2>ê°œì¸ ì¡°ê±´ ì…ë ¥</h2>
    </div>
    <div class="sec-sub">ì•„ë˜ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ 10ê°œ ì²­ì•½ ìœ í˜•ì˜ ìê²© ì—¬ë¶€, ê°€ì , ì¶”ì²œ ë‹¨ì§€, ì‹¤í–‰ ë¡œë“œë§µì„ ìë™ ìƒì„±í•©ë‹ˆë‹¤.</div>

    <div class="form-card">
      <div class="form-grid">
        <div class="field"><label>ê±°ì£¼ì§€</label><input id="residence" placeholder="ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ / ê²½ê¸°ë„ ì„±ë‚¨ì‹œ"></div>

        <div class="field half"><label>í˜¼ì¸ ê¸°ê°„ <small>ë§Œ 7ë…„ ì´ë‚´ ì‹ í˜¼</small></label><div class="input-wrap"><input type="number" id="marriageYears" placeholder="2" min="0"><span class="input-suffix">ë…„ì°¨</span></div></div>
        <div class="field half"><label>ìë…€ ë‚˜ì´ (ë§Œ) <small>ì‰¼í‘œ êµ¬ë¶„</small></label><input id="childAges" placeholder="1, 3"></div>

        <div class="field half"><label>ì†Œë“ í˜•íƒœ</label><div class="opt-group" id="incomeTypeGroup"><button class="opt-btn active" data-value="ì™¸ë²Œì´" onclick="sel('incomeTypeGroup',this)">ì™¸ë²Œì´</button><button class="opt-btn" data-value="ë§ë²Œì´" onclick="sel('incomeTypeGroup',this)">ë§ë²Œì´</button></div></div>
        <div class="field half"><label>í•©ì‚° ì›”ì†Œë“</label><div class="input-wrap"><input type="number" id="monthlyIncome" placeholder="600" min="0"><span class="input-suffix">ë§Œì›</span></div></div>

        <div class="field half"><label>ë¶€ë™ì‚° ë³´ìœ ê°€ì•¡ <small>ê³µì‹œê°€</small></label><div class="input-wrap"><input type="number" id="realEstateValue" placeholder="15000" min="0"><span class="input-suffix">ë§Œì›</span></div></div>
        <div class="field half"><label>ì°¨ëŸ‰ ì‹œê°€</label><div class="input-wrap"><input type="number" id="carValue" placeholder="500" min="0"><span class="input-suffix">ë§Œì›</span></div></div>

        <div class="field"><label>ì²­ì•½í†µì¥ ì¢…ë¥˜</label><div class="opt-group" id="accountTypeGroup"><button class="opt-btn active" data-value="ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•" onclick="sel('accountTypeGroup',this)">ì£¼íƒì²­ì•½ì¢…í•©ì €ì¶•</button><button class="opt-btn" data-value="ì²­ì•½ì €ì¶•" onclick="sel('accountTypeGroup',this)">ì²­ì•½ì €ì¶•</button><button class="opt-btn" data-value="ì²­ì•½ì˜ˆê¸ˆ" onclick="sel('accountTypeGroup',this)">ì²­ì•½ì˜ˆê¸ˆ</button></div></div>

        <div class="field half"><label>í†µì¥ ê°€ì…ê¸°ê°„</label><div class="input-wrap"><input type="number" id="accountYears" placeholder="10" min="0"><span class="input-suffix">ë…„</span></div></div>
        <div class="field half"><label>ë‚©ì… íšŸìˆ˜</label><div class="input-wrap"><input type="number" id="accountPayments" placeholder="120" min="0"><span class="input-suffix">íšŒ</span></div></div>

        <div class="field half"><label>ë¬´ì£¼íƒ ì„¸ëŒ€ì£¼ ì—¬ë¶€</label><div class="opt-group" id="homelessGroup"><button class="opt-btn active" data-value="ì˜ˆ" onclick="sel('homelessGroup',this)">ì˜ˆ</button><button class="opt-btn" data-value="ì•„ë‹ˆì˜¤" onclick="sel('homelessGroup',this)">ì•„ë‹ˆì˜¤</button></div></div>
      </div>

      <button class="analyze-btn" id="analyzeBtn" onclick="runAnalysis()">ğŸ” ì²­ì•½ ì „ëµ ë¶„ì„ ì‹œì‘</button>
    </div>
  </div>

  <!-- ===================== TAB 2: ì „ëµ ë¶„ì„ ===================== -->
  <div class="tab-panel" id="tab2">
    <div id="tab2Content">
      <div class="empty-state">
        <div class="empty-icon">ğŸ”</div>
        <div class="empty-title">ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>
        <div class="empty-desc">ë¨¼ì € [ì¡°ê±´ ì…ë ¥] íƒ­ì—ì„œ ê°œì¸ ì¡°ê±´ì„ ì…ë ¥í•˜ê³ <br>ë¶„ì„ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.</div>
        <button class="go-btn" onclick="switchTab('tab1')">ì¡°ê±´ ì…ë ¥í•˜ëŸ¬ ê°€ê¸° â†’</button>
      </div>
    </div>
  </div>

  <!-- ===================== TAB 3: ê³µê¸‰ ë‹¨ì§€ ===================== -->
  <div class="tab-panel" id="tab3">
    <div id="tab3Content">
      <div class="empty-state">
        <div class="empty-icon">ğŸ—</div>
        <div class="empty-title">ì¶”ì²œ ë‹¨ì§€ë¥¼ í™•ì¸í•˜ë ¤ë©´</div>
        <div class="empty-desc">ë¨¼ì € [ì¡°ê±´ ì…ë ¥] íƒ­ì—ì„œ ë¶„ì„ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.<br>ìê²©ì— ë§ëŠ” ë‹¨ì§€ë¥¼ ìë™ìœ¼ë¡œ í•„í„°ë§í•©ë‹ˆë‹¤.</div>
        <button class="go-btn" onclick="switchTab('tab1')">ì¡°ê±´ ì…ë ¥í•˜ëŸ¬ ê°€ê¸° â†’</button>
      </div>
    </div>
  </div>

  <!-- ===================== TAB 4: ë¡œë“œë§µ ===================== -->
  <div class="tab-panel" id="tab4">
    <div id="tab4Content">
      <div class="empty-state">
        <div class="empty-icon">ğŸ—º</div>
        <div class="empty-title">ì‹¤í–‰ ë¡œë“œë§µì„ í™•ì¸í•˜ë ¤ë©´</div>
        <div class="empty-desc">ë¨¼ì € [ì¡°ê±´ ì…ë ¥] íƒ­ì—ì„œ ë¶„ì„ì„ ì‹¤í–‰í•´ ì£¼ì„¸ìš”.<br>ë§ì¶¤í˜• ë‹¨ê³„ë³„ í–‰ë™ ê³„íšì„ ìƒì„±í•©ë‹ˆë‹¤.</div>
        <button class="go-btn" onclick="switchTab('tab1')">ì¡°ê±´ ì…ë ¥í•˜ëŸ¬ ê°€ê¸° â†’</button>
      </div>
    </div>
  </div>

</div>

<script>
// ============================
// DATA
// ============================
const MI = 576.5; // 4ì¸ê°€êµ¬ ê¸°ì¤€ì¤‘ìœ„ì†Œë“ ë§Œì›/ì›”

const TYPES = [
  {id:"pub_nat",cat:"ê³µê³µì„ëŒ€",name:"LH êµ­ë¯¼ì„ëŒ€",iL:.7,iLD:null,ast:24700,car:4563,re:21550,met:"ì¶”ì²¨Â·ìš°ì„ ",rent:"ì‹œì„¸ 30~50%",per:"30ë…„",ch:"ìë…€ ìš°ì„ ê³µê¸‰",dif:"ë‚®ìŒ",note:"ì˜êµ¬ ê±°ì£¼ ê°€ëŠ¥",seoul:0},
  {id:"pub_hap",cat:"ê³µê³µì„ëŒ€",name:"LH í–‰ë³µì£¼íƒ(ì‹ í˜¼)",iL:1,iLD:1.2,ast:24700,car:4563,re:21550,met:"ìš°ì„ 30%+ì¼ë°˜20%",rent:"ì‹œì„¸ 60~80%",per:"6ë…„(ìë…€ì‹œ 10ë…„)",ch:"ìë…€ ì‹œ 4ë…„ ì—°ì¥",dif:"ì¤‘ê°„",note:"ì—­ì„¸ê¶Œ ìœ„ì£¼",seoul:0},
  {id:"pub_js1",cat:"ê³µê³µì„ëŒ€",name:"LH ì „ì„¸ì„ëŒ€(â… í˜•)",iL:1,iLD:null,ast:36100,car:4563,re:21550,met:"ì¶”ì²œë°©ì‹",rent:"ë³´ì¦ê¸ˆ ì§€ì›, æœˆì´ìë§Œ",per:"2ë…„+ì¬ê³„ì•½",ch:"ìš°ì„ ìˆœìœ„",dif:"ë‚®ìŒ",note:"ì‹¤ê±°ì£¼ ì„ íƒ ììœ ",seoul:0},
  {id:"pub_js2",cat:"ê³µê³µì„ëŒ€",name:"LH ì „ì„¸ì„ëŒ€(â…¡í˜•)",iL:1.4,iLD:null,ast:36100,car:4563,re:21550,met:"ì¶”ì²œë°©ì‹",rent:"ë³´ì¦ê¸ˆ ì§€ì›, æœˆì´ìë§Œ",per:"2ë…„+ì¬ê³„ì•½",ch:"ìë…€ê°€ì‚°",dif:"ë‚®ìŒ",note:"â… í˜• ì†Œë“ì´ˆê³¼ ì‹œ",seoul:0},
  {id:"sh_js",cat:"ì„œìš¸SH",name:"SH ì¥ê¸°ì „ì„¸(ì‹œí”„íŠ¸)",iL:1.2,iLD:null,ast:37900,car:4563,re:21550,met:"ìš°ì„ Â·ì¼ë°˜",rent:"ì‹œì„¸ 80% ì „ì„¸í˜•",per:"20ë…„",ch:"ìë…€ ìš°ì„  10%",dif:"ë†’ìŒ",note:"ì„œìš¸ ì „ì„¸ í•µì‹¬",seoul:1},
  {id:"pub_new",cat:"ê³µê³µë¶„ì–‘",name:"ê³µê³µë¶„ì–‘ ì‹ í˜¼íŠ¹ê³µ",iL:1.3,iLD:null,ast:37900,car:4563,re:21550,met:"ìš°ì„ 30%+ì¼ë°˜70%",rent:"ì‹œì„¸ 70~80%",per:"ì†Œìœ ê¶Œ ì·¨ë“",ch:"ìë…€ ìš°ì„ ê³µê¸‰",dif:"ë†’ìŒ",note:"10ë…„ ì „ë§¤ì œí•œ",seoul:0,newlywed:1},
  {id:"pub_gen",cat:"ê³µê³µë¶„ì–‘",name:"ê³µê³µë¶„ì–‘ ì¼ë°˜ê³µê¸‰",iL:null,iLD:null,ast:37900,car:4563,re:21550,met:"ìˆœìœ„ë³„",rent:"ì‹œì„¸ 70~80%",per:"ì†Œìœ ê¶Œ ì·¨ë“",ch:"ì—†ìŒ",dif:"ì¤‘ê°„",note:"í†µì¥ë‚©ì… ì¤‘ìš”",seoul:0},
  {id:"pvt_new",cat:"ë¯¼ì˜ì£¼íƒ",name:"ë¯¼ì˜ ì‹ í˜¼íŠ¹ê³µ",iL:1.4,iLD:1.6,ast:null,car:null,re:null,met:"ìš°ì„ 30%+ì¼ë°˜70%",rent:"ì‹œì¥ê°€",per:"ì†Œìœ ê¶Œ ì·¨ë“",ch:"ìë…€ ê°€ì‚°ì ",dif:"ë†’ìŒ",note:"íˆ¬ê¸°ê³¼ì—´: ê°€ì 100%",seoul:0,newlywed:1},
  {id:"pvt_gen",cat:"ë¯¼ì˜ì£¼íƒ",name:"ë¯¼ì˜ ì¼ë°˜ê³µê¸‰ ì¶”ì²¨ì œ",iL:null,iLD:null,ast:null,car:null,re:null,met:"ì¶”ì²¨",rent:"ì‹œì¥ê°€",per:"ì†Œìœ ê¶Œ ì·¨ë“",ch:"ì—†ìŒ",dif:"ë§¤ìš° ë†’ìŒ",note:"85ã¡â†‘ ì¶”ì²¨ë¹„ìœ¨â†‘",seoul:0},
  {id:"hope",cat:"ì‹ í˜¼í¬ë§íƒ€ìš´",name:"ì‹ í˜¼í¬ë§íƒ€ìš´(LH)",iL:1.3,iLD:2,ast:354000,car:4563,re:null,met:"ìˆœìœ„ë³„",rent:"ë¶„ì–‘ê°€ìƒí•œì œ",per:"ì†Œìœ ê¶Œ ì·¨ë“",ch:"2ìë…€â†‘ 1ìˆœìœ„â‘ ",dif:"ì¤‘ê°„",note:"3ê¸° ì‹ ë„ì‹œ ì¤‘ì‹¬",seoul:0,newlywed:1},
];

const PRI = {pvt_new:1,hope:2,pub_new:3,sh_js:4,pub_js1:5,pub_js2:6,pub_hap:7,pub_nat:8,pub_gen:9,pvt_gen:10};

const SUPPLY = [
  {name:"ê³ ë•ê°•ì¼ ê³µê³µë¶„ì–‘",area:"ì„œìš¸",units:1305,org:"SH",time:"2026 ìƒë°˜ê¸°",type:"ê³µê³µë¶„ì–‘"},
  {name:"ë‚¨ì–‘ì£¼ ì™•ìˆ™ 3ê¸°",area:"ê²½ê¸°",units:1868,org:"LH",time:"2026 1ë¶„ê¸°",type:"ì‹ í˜¼í¬ë§íƒ€ìš´"},
  {name:"ê³ ì–‘ ì°½ë¦‰ 3ê¸°",area:"ê²½ê¸°",units:3881,org:"GH",time:"2026 í•˜ë°˜ê¸°",type:"ì‹ í˜¼í¬ë§íƒ€ìš´"},
  {name:"ì¸ì²œ ê³„ì–‘ 3ê¸°",area:"ì¸ì²œ",units:1290,org:"iH",time:"2026 2ë¶„ê¸°",type:"ì‹ í˜¼í¬ë§íƒ€ìš´"},
  {name:"í‰íƒ ê³ ë• 2ê¸°",area:"ê²½ê¸°",units:5134,org:"LH",time:"2026 2~3ë¶„ê¸°",type:"ë¯¼ê°„ë¶„ì–‘"},
  {name:"í™”ì„± ë™íƒ„2",area:"ê²½ê¸°",units:473,org:"LH",time:"2026 5ì›”",type:"ë¯¼ê°„ë¶„ì–‘"},
  {name:"ê´‘êµ 2ê¸°",area:"ê²½ê¸°",units:600,org:"GH",time:"2026 ì¤‘ë°˜",type:"ë¯¼ê°„ë¶„ì–‘"},
  {name:"ê³ ì–‘ì •ë°œ S-01",area:"ê²½ê¸°",units:494,org:"GH",time:"2026 3ì›”",type:"ë¯¼ê°„ë¶„ì–‘"},
  {name:"ë‚¨ì–‘ì£¼ ë³„ë‚´2",area:"ê²½ê¸°",units:606,org:"GH",time:"2026 3ì›”",type:"ë¯¼ê°„ë¶„ì–‘"},
];

const TARGETS = [
  {area:"ì„œìš¸ ê°•ë¶ê¶Œ",detail:"ë„ë´‰Â·ë…¸ì›Â·ì¤‘ë‘Â·ê°•ë¶ ì¬ê°œë°œ",comp:"20~40:1",suit:"ê²½ìŸ ê°€ëŠ¥ êµ¬ê°„",lv:1},
  {area:"ê²½ê¸° í‰íƒ",detail:"ê³ ë•êµ­ì œì‹ ë„ì‹œ ë¯¼ê°„",comp:"5~15:1",suit:"âœ“ ìµœìš°ì„  ì¶”ì²œ",lv:3},
  {area:"í™”ì„± ë™íƒ„2",detail:"ë™íƒ„2 ìˆ˜ì‹œ ë¯¼ê°„",comp:"10~30:1",suit:"âœ“ ì‹ ìƒì•„+ê°€ì  ìœ ë¦¬",lv:2},
  {area:"ê²½ê¸° ìˆ˜ì›",detail:"ê´‘êµÂ·ì˜í†µÂ·ì¸ê³„",comp:"15~35:1",suit:"âœ“ ì‹ ìƒì•„ ìš°ì„  ìœ ë¦¬",lv:2},
  {area:"ê²½ê¸° ì˜ì •ë¶€",detail:"GTX-C ì˜ˆì •ì§€",comp:"10~20:1",suit:"êµí†µ í˜¸ì¬ + ì €ë ´",lv:1},
  {area:"ê²½ê¸° ë‚¨ì–‘ì£¼",detail:"ì™•ìˆ™Â·ë³„ë‚´Â·ë‹¤ì‚°",comp:"10~25:1",suit:"3ê¸°ì‹ ë„ì‹œ ì¸ê·¼",lv:1},
];

const CC = {ê³µê³µì„ëŒ€:"var(--green)",ì„œìš¸SH:"var(--purple)",ê³µê³µë¶„ì–‘:"var(--accent)",ë¯¼ì˜ì£¼íƒ:"var(--orange)",ì‹ í˜¼í¬ë§íƒ€ìš´:"var(--pink)"};
const CD = {ê³µê³µì„ëŒ€:"var(--green-dim)",ì„œìš¸SH:"var(--purple-dim)",ê³µê³µë¶„ì–‘:"var(--accent-dim)",ë¯¼ì˜ì£¼íƒ:"var(--orange-dim)",ì‹ í˜¼í¬ë§íƒ€ìš´:"var(--pink-dim)"};
const TC = {ì‹ í˜¼í¬ë§íƒ€ìš´:"var(--pink)",ë¯¼ê°„ë¶„ì–‘:"var(--orange)",ê³µê³µë¶„ì–‘:"var(--accent)"};
const TD = {ì‹ í˜¼í¬ë§íƒ€ìš´:"var(--pink-dim)",ë¯¼ê°„ë¶„ì–‘:"var(--orange-dim)",ê³µê³µë¶„ì–‘:"var(--accent-dim)"};

let analysisResult = null;

// ============================
// UI HELPERS
// ============================
function sel(gid,btn){document.querySelectorAll('#'+gid+' .opt-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active')}
function gv(gid){const a=document.querySelector('#'+gid+' .opt-btn.active');return a?a.dataset.value:''}
function v(id){return document.getElementById(id).value.trim()}
function n(id){return parseInt(document.getElementById(id).value)||0}
function bg(text,color,bgc){return `<span class="badge" style="color:${color};background:${bgc}">${text}</span>`}

function switchTab(tabId) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
  document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}

// ============================
// ANALYSIS ENGINE
// ============================
function runAnalysis() {
  const res = v('residence')||'ê²½ê¸°ë„';
  const my = n('marriageYears');
  const caRaw = v('childAges');
  const ca = caRaw ? caRaw.split(',').map(s=>parseInt(s.trim())).filter(x=>!isNaN(x)) : [];
  const it = gv('incomeTypeGroup');
  const mi = n('monthlyIncome');
  const re = n('realEstateValue');
  const cv = n('carValue');
  const ay = n('accountYears');
  const ap = n('accountPayments');
  const hl = gv('homelessGroup')==='ì˜ˆ';
  const dual = it==='ë§ë²Œì´';
  const seoul = res.includes('ì„œìš¸');
  const newborn = ca.some(a=>a<=2);
  const cc = ca.filter(a=>a>=0).length;
  const tot = re+cv;
  const first = ap>=24&&ay>=2;

  const results = TYPES.map(t => {
    let ok=true; const reasons=[]; const warnings=[];
    if(!hl){ok=false;reasons.push('ë¬´ì£¼íƒ ìš”ê±´ ë¯¸ì¶©ì¡±')}
    if(t.newlywed&&my>7){ok=false;reasons.push('í˜¼ì¸ 7ë…„ ì´ˆê³¼')}
    if(t.seoul&&!seoul){ok=false;reasons.push('ì„œìš¸ ê±°ì£¼ìë§Œ ê°€ëŠ¥')}
    if(t.iL!==null){
      let lim=t.iL;if(dual&&t.iLD)lim=t.iLD;
      const la=Math.round(MI*lim);
      if(mi>la){ok=false;reasons.push(`ì›”ì†Œë“ ${mi.toLocaleString()}ë§Œ > ê¸°ì¤€ ${la.toLocaleString()}ë§Œ (ì¤‘ìœ„${Math.round(lim*100)}%)`)}
      else warnings.push(`ì†Œë“ ì¶©ì¡± (${Math.round(mi/la*100)}%)`)
    } else warnings.push('ì†Œë“ê¸°ì¤€ ì—†ìŒ âœ“');
    if(t.re!==null&&re>t.re){ok=false;reasons.push(`ë¶€ë™ì‚° ${(re/10000).toFixed(1)}ì–µ > ${(t.re/10000).toFixed(2)}ì–µ`)}
    if(t.id==='hope'&&t.ast!==null&&tot>t.ast){ok=false;reasons.push('ì´ìì‚° ì´ˆê³¼')}
    if(t.car!==null&&cv>t.car){ok=false;reasons.push(`ì°¨ëŸ‰ ${cv.toLocaleString()}ë§Œ > ${t.car.toLocaleString()}ë§Œ`)}

    let score=null;
    if(t.id==='pvt_new'){
      let s=0;
      s+=ap>=24?12:ap>=12?8:ap>=6?4:2;
      s+=my<=2?3:my<=4?2:1;
      s+=cc>=2?10:cc>=1?5:0;
      s+=my>=5?5:my>=3?3:2;
      const fam=1+(my>0?1:0)+cc;
      s+=fam>=4?5:fam>=3?3:1;
      score=s;
    }
    let hr=null;
    if(t.id==='hope'&&ok) hr=cc>=2?'1ìˆœìœ„â‘ ':cc>=1?'1ìˆœìœ„â‘¡':'2ìˆœìœ„';

    return {...t,ok,reasons,warnings,score,first,newborn,hr,cc};
  });

  const eligible = results.filter(r=>r.ok).sort((a,b)=>(PRI[a.id]||99)-(PRI[b.id]||99));
  const ineligible = results.filter(r=>!r.ok);
  const eids = eligible.map(e=>e.id);
  const recSupply = SUPPLY.map(s => {
    let rec = false;
    if(eids.includes('hope')&&s.type==='ì‹ í˜¼í¬ë§íƒ€ìš´') rec=true;
    if(eids.includes('pvt_new')&&s.type==='ë¯¼ê°„ë¶„ì–‘') rec=true;
    if(eids.includes('pub_new')&&s.type==='ê³µê³µë¶„ì–‘') rec=true;
    return {...s,rec};
  });
  const pvtScore = eligible.find(e=>e.id==='pvt_new')?.score;

  analysisResult = {eligible,ineligible,recSupply,pvtScore,first,newborn,cc,res};

  // Update tab badges
  const ne = document.getElementById('numEligible');
  ne.textContent = eligible.length;
  ne.style.color = 'var(--green)';
  ne.style.background = 'var(--green-dim)';
  ne.classList.add('show');

  const ns = document.getElementById('numSupply');
  ns.textContent = recSupply.filter(s=>s.rec).length;
  ns.style.color = 'var(--accent)';
  ns.style.background = 'var(--accent-dim)';
  ns.classList.add('show');

  renderTab2();
  renderTab3();
  renderTab4();
  switchTab('tab2');
}

// ============================
// TAB 2: ì „ëµ ë¶„ì„
// ============================
function renderTab2() {
  const d = analysisResult;
  if(!d) return;
  let h = '';

  // Stats
  h += `<div class="stats-grid">`;
  [{i:'âœ“',l:'ì‹ ì²­ ê°€ëŠ¥',v:`${d.eligible.length}ê±´`,c:'var(--green)'},{i:'âœ—',l:'ì‹ ì²­ ë¶ˆê°€',v:`${d.ineligible.length}ê±´`,c:'var(--red)'},{i:'ğŸ—',l:'ì¶”ì²œ ë‹¨ì§€',v:`${d.recSupply.filter(s=>s.rec).length}ê³³`,c:'var(--accent)'},{i:'â˜…',l:'ì‹ í˜¼ ê°€ì ',v:d.pvtScore?`${d.pvtScore}ì `:'â€”',c:'var(--orange)'}].forEach(s=>{
    h+=`<div class="stat-card"><div class="stat-icon">${s.i}</div><div class="stat-value" style="color:${s.c}">${s.v}</div><div class="stat-label">${s.l}</div></div>`;
  });
  h += `</div>`;

  // Eligible
  if(d.eligible.length){
    h += `<div class="sec-head"><div class="sec-icon" style="background:var(--green-dim)">ğŸ¯</div><h2>ì‹ ì²­ ê°€ëŠ¥ ìœ í˜• <span style="color:var(--green)">ìš°ì„ ìˆœìœ„ ìˆœ</span></h2></div>`;
    d.eligible.forEach((item,i) => {
      const c=CC[item.cat]||'var(--accent)', cd=CD[item.cat]||'var(--accent-dim)';
      const top=i<2;
      h += `<div class="result-card ${top?'top':''}" onclick="this.classList.toggle('open')">`;
      h += `<div class="result-head"><div class="result-left">
        <div class="rank-num" style="background:${cd};color:${c}">${i+1}</div>
        <div><div class="result-name">${item.name}</div><div class="badges">`;
      h += bg(item.cat,c,cd);
      if(item.newborn&&item.ch!=='ì—†ìŒ') h+=bg('ì‹ ìƒì•„ ìš°ì„ ','var(--green)','var(--green-dim)');
      if(item.hr) h+=bg(item.hr,'var(--pink)','var(--pink-dim)');
      if(item.first) h+=bg('1ìˆœìœ„','var(--accent)','var(--accent-dim)');
      h += `</div></div></div><div class="arrow">â–¼</div></div>`;

      if(item.score!==null){
        const pct=Math.min(item.score/35*100,100);
        const sc=pct>=75?'var(--green)':pct>=50?'var(--orange)':'var(--red)';
        h+=`<div class="score-section"><div class="score-label">ë¯¼ê°„ë¶„ì–‘ ì‹ í˜¼íŠ¹ê³µ ê°€ì  (35ì  ë§Œì )</div><div class="score-row"><div class="score-track"><div class="score-fill" style="width:${pct}%;background:linear-gradient(90deg,${sc},${sc}cc)"></div></div><div class="score-num" style="color:${sc}">${item.score}/35ì </div></div></div>`;
      }

      h += `<div class="detail-panel"><div class="detail-grid">`;
      [['ê³µê¸‰ë°©ì‹',item.met],['ì„ëŒ€ë£Œ/ë¶„ì–‘ê°€',item.rent],['ê±°ì£¼ê¸°ê°„',item.per],['ìë…€í˜œíƒ',item.ch],['ë‚œì´ë„',item.dif],['ë¹„ê³ ',item.note]].forEach(([k,vv])=>{
        h+=`<div><div class="detail-key">${k}</div><div class="detail-val">${vv}</div></div>`;
      });
      h += `</div>`;
      if(item.warnings.length){
        h+=`<div class="warn-tags">`;
        item.warnings.forEach(w=>{h+=`<span class="warn-tag" style="color:var(--green);background:var(--green-dim)">âœ“ ${w}</span>`});
        h+=`</div>`;
      }
      h += `</div></div>`;
    });
  }

  // Ineligible
  if(d.ineligible.length){
    h += `<div style="margin-top:28px"><div class="sec-head"><div class="sec-icon" style="background:var(--red-dim)">âŠ˜</div><h2 style="color:var(--text-dim)">ì‹ ì²­ ë¶ˆê°€ ìœ í˜• <span style="color:var(--red)">ì‚¬ìœ  ì•ˆë‚´</span></h2></div>`;
    d.ineligible.forEach(item=>{
      h+=`<div class="ineligible-card"><div class="ineligible-head"><div><span class="ineligible-name">${item.name}</span><span class="ineligible-cat">${item.cat}</span></div>${bg('ë¶ˆê°€','var(--red)','var(--red-dim)')}</div><div class="reason-tags">`;
      item.reasons.forEach(r=>{h+=`<span class="warn-tag" style="color:var(--red);background:var(--red-dim)">âœ— ${r}</span>`});
      h+=`</div></div>`;
    });
    h += `</div>`;
  }

  h += `<div class="disclaimer">â€» ë³¸ ë¶„ì„ì€ 2026ë…„ ê¸°ì¤€ ì²­ì•½ ê·œì •ì„ ë°˜ì˜í•œ ì°¸ê³ ìš© ìë£Œì…ë‹ˆë‹¤. ì‹¤ì œ ì²­ì•½ ì‹œ ê³µê³ ë¬¸ì„ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”.<br>ì†Œë“ê¸°ì¤€: 4ì¸ê°€êµ¬ ê¸°ì¤€ì¤‘ìœ„ì†Œë“ ${Math.round(MI*10000).toLocaleString()}ì›/ì›” ê¸°ì¤€</div>`;

  document.getElementById('tab2Content').innerHTML = h;
}

// ============================
// TAB 3: ê³µê¸‰ ë‹¨ì§€
// ============================
let supplyFilter = 'ì „ì²´';

function renderTab3() {
  const d = analysisResult;
  if(!d) return;
  let h = '';

  h += `<div class="sec-head"><div class="sec-icon" style="background:var(--accent-dim)">ğŸ—</div><h2>2026 ìˆ˜ë„ê¶Œ ê³µê¸‰ ë‹¨ì§€</h2></div>`;

  const recCount = d.recSupply.filter(s=>s.rec).length;
  const totalUnits = d.recSupply.reduce((a,s)=>a+s.units,0);
  h += `<div class="supply-total">ì „ì²´ <b>${SUPPLY.length}ê°œ ë‹¨ì§€</b> Â· ì´ <b>${totalUnits.toLocaleString()}í˜¸</b> Â· ë‚´ ì¡°ê±´ ì¶”ì²œ <b>${recCount}ê³³</b></div>`;

  // Filters
  const types = ['ì „ì²´','ì¶”ì²œë§Œ','ì‹ í˜¼í¬ë§íƒ€ìš´','ë¯¼ê°„ë¶„ì–‘','ê³µê³µë¶„ì–‘'];
  h += `<div class="supply-filter-bar" id="supplyFilters">`;
  types.forEach(t => {
    h += `<button class="supply-filter ${t===supplyFilter?'active':''}" onclick="filterSupply('${t}')">${t}</button>`;
  });
  h += `</div>`;

  h += `<div class="supply-grid" id="supplyGrid">`;
  d.recSupply.forEach((s,i) => {
    const show = supplyFilter==='ì „ì²´' || (supplyFilter==='ì¶”ì²œë§Œ'&&s.rec) || supplyFilter===s.type;
    if(!show) return;
    const tc=TC[s.type]||'var(--accent)', td=TD[s.type]||'var(--accent-dim)';
    h += `<div class="supply-card" style="position:relative;${s.rec?'border-color:rgba(34,211,238,.18)':''}">`;
    if(s.rec) h+=`<div style="position:absolute;top:10px;right:12px;font-size:10px;font-weight:700;color:var(--accent);background:var(--accent-dim);padding:2px 8px;border-radius:4px">âœ“ ì¶”ì²œ</div>`;
    h += `<div class="supply-head"><div class="supply-name">${s.name}</div>${bg(s.type,tc,td)}</div>
      <div class="supply-info">
        <div><div class="supply-key">ê³µê¸‰ëŸ‰</div><div class="supply-val">${s.units.toLocaleString()}í˜¸</div></div>
        <div><div class="supply-key">ê¸°ê´€</div><div class="supply-val">${s.org}</div></div>
        <div><div class="supply-key">ì§€ì—­</div><div class="supply-val">${s.area}</div></div>
        <div><div class="supply-key">ì‹œê¸°</div><div class="supply-val">${s.time}</div></div>
      </div></div>`;
  });
  h += `</div>`;

  // Target areas table
  h += `<div style="margin-top:28px"><div class="sec-head"><div class="sec-icon" style="background:var(--orange-dim)">ğŸ“</div><h2>ë¯¼ê°„ë¶„ì–‘ íƒ€ê¹ƒ ì§€ì—­ ë¶„ì„</h2></div>
    <div class="data-table-wrap"><table class="data-table"><thead><tr><th>ì§€ì—­</th><th>ì£¼ìš” ë‹¨ì§€</th><th>ì˜ˆìƒ ê²½ìŸë¥ </th><th>ì í•©ì„±</th></tr></thead><tbody>`;
  TARGETS.forEach(t=>{
    const sc=t.lv===3?'var(--green)':t.lv===2?'var(--accent)':'var(--text-dim)';
    h+=`<tr><td style="font-weight:700;color:var(--text)">${t.area}</td><td>${t.detail}</td><td style="color:var(--orange);font-weight:700">${t.comp}</td><td style="color:${sc};font-weight:600">${t.suit}</td></tr>`;
  });
  h += `</tbody></table></div></div>`;

  document.getElementById('tab3Content').innerHTML = h;
}

function filterSupply(type) {
  supplyFilter = type;
  renderTab3();
}

// ============================
// TAB 4: ë¡œë“œë§µ
// ============================
function renderTab4() {
  const d = analysisResult;
  if(!d) return;
  let h = '';

  h += `<div class="sec-head"><div class="sec-icon" style="background:var(--purple-dim)">ğŸ—º</div><h2>2026~2028 ë§ì¶¤ ì‹¤í–‰ ë¡œë“œë§µ</h2></div>`;
  h += `<div class="sec-sub">ì²´í¬ë°•ìŠ¤ë¥¼ ëˆŒëŸ¬ ì™„ë£Œí•œ í•­ëª©ì„ ê´€ë¦¬í•˜ì„¸ìš”. ë¶„ì„ ê²°ê³¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ëœ ë§ì¶¤ í–‰ë™ ê³„íšì…ë‹ˆë‹¤.</div>`;

  const topNames = d.recSupply.filter(s=>s.rec).slice(0,3).map(s=>s.name).join(', ')||'í‰íƒÂ·ë™íƒ„Â·ë‚¨ì–‘ì£¼';
  const eligItems = d.eligible.slice(0,3).map(e=>{
    let s=e.name;
    if(e.hr) s+=` ${e.hr}`;
    if(e.score) s+=` ê°€ì  ${e.score}ì `;
    if(e.newborn&&e.ch!=='ì—†ìŒ') s+=' â€” ì‹ ìƒì•„ ìš°ì„  í™œìš©';
    else s+=' â€” ì ê·¹ ì‹ ì²­';
    return s;
  });

  const steps = [
    {s:1,p:'2026 ìƒë°˜ê¸°',t:'ì¦‰ì‹œ ì‹¤í–‰ â€” ì¤€ë¹„ ë‹¨ê³„',c:'var(--accent)',items:[
      'ë¬´ì£¼íƒ í™•ì • ì¦ë¹™ ì¤€ë¹„ (ì£¼ë¯¼ë“±ë¡ë“±ë³¸Â·í† ì§€ëŒ€ì¥Â·ê±´ì¶•ë¬¼ëŒ€ì¥)',
      'ì²­ì•½í™ˆ(applyhome.co.kr) ì•± ì„¤ì¹˜ â†’ ê´€ì‹¬ì§€ì—­ ì•Œë¦¼ ON',
      'LHì²­ì•½í”ŒëŸ¬ìŠ¤(apply.lh.or.kr) ê³µê³  ìˆ˜ì‹  ì„¤ì •',
      'ì²­ì•½í†µì¥ ë‚©ì… ìœ ì§€ â€” ì ˆëŒ€ ì¤‘ë‹¨ ê¸ˆì§€',
      `ê´€ì‹¬ ì§€ì—­ ì„ ì •: ${topNames}`,
    ]},
    {s:2,p:'2026 1~2ë¶„ê¸°',t:'ë¶„ì–‘ ë„ì „ â€” ë™ì‹œ ê³µëµ',c:'var(--green)',items:
      eligItems.length?[...eligItems,'ì†Œë“ ê¸°ì¤€ ì¶©ì¡± ì—¬ë¶€ ì£¼ê¸°ì  ì ê²€']:['í•´ë‹¹ ìœ í˜• ì—†ìŒ â€” ì¡°ê±´ ë³€ê²½ ê²€í† ']
    },
    {s:3,p:'2026 í•˜ë°˜ê¸°',t:'í™•ì¥ ê³µëµ â€” í•˜ë°˜ê¸° ë¬¼ëŸ‰',c:'var(--orange)',items:[
      'ê³ ì–‘ ì°½ë¦‰ 3ê¸° ì‹ í˜¼í¬ë§íƒ€ìš´ (GTX-A ìˆ˜í˜œ, 3,881í˜¸ ëŒ€ê·œëª¨)',
      'ì„œìš¸ ê°•ë¶ê¶Œ ë¯¼ê°„ë¶„ì–‘ ì¬ê°œë°œ ë‹¨ì§€ ëª¨ë‹ˆí„°ë§',
      'ê°€ì  ê´€ë¦¬ â€” ë¬´ì£¼íƒ ê¸°ê°„ ëˆ„ì ìœ¼ë¡œ ê°€ì  ìƒìŠ¹ í™•ì¸',
      'ì¶”ê°€ ìë…€ ê³„íš ì‹œ ê°€ì  +5ì  íš¨ê³¼ ê²€í† ',
    ]},
    {s:4,p:'2027~2028ë…„',t:'ì¥ê¸° ì „ëµ â€” ê¸°ê°„ í™œìš© ê·¹ëŒ€í™”',c:'var(--purple)',items:[
      'ì‹ í˜¼ íŠ¹ê³µ ë§Œë£Œ ì „ ë¶„ì–‘ í™•ë³´ (í˜¼ì¸ 7ë…„ ì´ë‚´)',
      'ì¼ë°˜ê³µê¸‰ ê°€ì  ì¶•ì  â†’ 40ì ëŒ€ ì§„ì… ì‹œ ê²½ê¸° ì™¸ê³½ ê³µëµ',
      'ìì‚° êµ¬ì¡° ë³€ê²½ ê²€í†  (ê³µê³µì„ëŒ€ ì¬ì§„ì… ê°€ëŠ¥ì„±)',
      'ì „ì„¸ ìœ ì§€í•˜ë©° ë¶„ì–‘ ì²­ì•½ ì§€ì† ë³‘í–‰',
    ]},
  ];

  h += `<div style="padding-left:2px">`;
  steps.forEach((r,ri)=>{
    h+=`<div class="roadmap-step" style="animation:slideIn .5s ease ${ri*.15}s both">
      <div class="roadmap-line">
        <div class="roadmap-dot" style="background:color-mix(in srgb,${r.c} 15%,transparent);border-color:${r.c};color:${r.c}">${r.s}</div>
        ${ri<steps.length-1?'<div class="roadmap-connector"></div>':''}
      </div>
      <div class="roadmap-content">
        <div class="roadmap-period" style="color:${r.c}">${r.p}</div>
        <div class="roadmap-title">${r.t}</div>
        <div class="roadmap-items">`;
    r.items.forEach((item,ii)=>{
      const uid=`chk_${ri}_${ii}`;
      h+=`<div class="roadmap-item" style="padding-right:40px">
        <span style="position:absolute;left:14px;color:${r.c};font-weight:900;font-size:15px">â€º</span>
        ${item}
        <div class="roadmap-check" id="${uid}" onclick="event.stopPropagation();toggleCheck('${uid}')"></div>
      </div>`;
    });
    h+=`</div></div></div>`;
  });
  h+=`</div>`;

  h += `<div class="disclaimer">â€» ë³¸ ë¡œë“œë§µì€ ì…ë ¥ëœ ê°œì¸ ì¡°ê±´ì„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ìƒì„±ëœ ì°¸ê³ ìš© ìë£Œì…ë‹ˆë‹¤.<br>ì‹¤ì œ ê³µê³  ì¼ì •ì€ LHÂ·SHÂ·GH ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ ë°˜ë“œì‹œ í™•ì¸í•˜ì„¸ìš”.</div>`;

  document.getElementById('tab4Content').innerHTML = h;
}

function toggleCheck(id) {
  const el = document.getElementById(id);
  if(el.classList.contains('checked')){
    el.classList.remove('checked');
    el.textContent = '';
  } else {
    el.classList.add('checked');
    el.textContent = 'âœ“';
  }
}
</script>
</body>
</html>
